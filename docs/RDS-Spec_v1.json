{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "RDS (Regulatory Data Signature) Specification v1.0",
  "description": "Specification for Regulatory Data Signatures ensuring evidence integrity and traceability",
  "type": "object",
  "required": ["version", "data", "canonical", "hash", "signature", "timestamp"],
  "properties": {
    "version": {
      "type": "string",
      "enum": ["1.0"],
      "description": "RDS specification version"
    },
    "type": {
      "type": "string",
      "enum": ["plan_rds", "ad_rds", "io_rds", "payment_rds", "generic_rds"],
      "description": "Type of RDS record"
    },
    "data": {
      "type": "object",
      "description": "Original data being signed",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the data"
        },
        "tenant_id": {
          "type": "string",
          "description": "Tenant identifier for multi-tenant systems"
        },
        "created_at": {
          "type": "string",
          "format": "date-time",
          "description": "Creation timestamp (ISO 8601)"
        }
      }
    },
    "canonical": {
      "type": "string",
      "description": "Canonicalized representation of data for deterministic hashing"
    },
    "hash": {
      "type": "string",
      "pattern": "^[a-f0-9]{64}$",
      "description": "SHA-256 hash of canonical data"
    },
    "signature": {
      "type": "object",
      "required": ["algorithm", "signature", "timestamp"],
      "properties": {
        "algorithm": {
          "type": "string",
          "enum": ["SHA256-RSA", "SHA256-ECDSA", "SHA256-HMAC"],
          "description": "Signature algorithm used"
        },
        "signature": {
          "type": "string",
          "description": "Digital signature of the hash"
        },
        "publicKey": {
          "type": "string",
          "description": "Public key for signature verification (optional)"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Signature timestamp (ISO 8601)"
        }
      }
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "RDS creation timestamp (ISO 8601)"
    },
    "merkleProof": {
      "type": "object",
      "description": "Merkle tree proof for batch verification (optional)",
      "properties": {
        "root": {
          "type": "string",
          "pattern": "^[a-f0-9]{64}$",
          "description": "Merkle tree root hash"
        },
        "leaf": {
          "type": "string",
          "pattern": "^[a-f0-9]{64}$",
          "description": "Leaf hash (should match main hash)"
        },
        "proof": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["hash", "position"],
            "properties": {
              "hash": {
                "type": "string",
                "pattern": "^[a-f0-9]{64}$",
                "description": "Sibling hash in Merkle path"
              },
              "position": {
                "type": "string",
                "enum": ["left", "right"],
                "description": "Position of sibling in tree"
              }
            }
          }
        }
      }
    },
    "chainAnchor": {
      "type": "object",
      "description": "Blockchain anchoring information (optional)",
      "properties": {
        "blockHeight": {
          "type": "integer",
          "description": "Block height where data is anchored"
        },
        "transactionId": {
          "type": "string",
          "description": "Transaction ID on blockchain"
        },
        "confirmations": {
          "type": "integer",
          "description": "Number of confirmations"
        },
        "network": {
          "type": "string",
          "description": "Blockchain network (e.g., 'bitcoin', 'ethereum')"
        }
      }
    },
    "approvals": {
      "type": "array",
      "description": "Approval records linked to this RDS",
      "items": {
        "type": "object",
        "required": ["approver_id", "approval_timestamp", "artifact_hash"],
        "properties": {
          "approver_id": {
            "type": "string",
            "description": "ID of the approver"
          },
          "approval_timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "When approval was granted"
          },
          "artifact_hash": {
            "type": "string",
            "pattern": "^[a-f0-9]{64}$",
            "description": "Hash of approved artifact"
          },
          "policy_hash": {
            "type": "string",
            "pattern": "^[a-f0-9]{64}$",
            "description": "Hash of policy at time of approval"
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata for the RDS",
      "properties": {
        "jurisdiction": {
          "type": "string",
          "description": "Legal jurisdiction"
        },
        "regulation": {
          "type": "string",
          "description": "Applicable regulation (e.g., 'SEC', 'FCA', 'MiFID')"
        },
        "retention_period": {
          "type": "string",
          "description": "Data retention period (ISO 8601 duration)"
        },
        "classification": {
          "type": "string",
          "enum": ["public", "internal", "confidential", "restricted"],
          "description": "Data classification level"
        }
      }
    }
  },
  "examples": [
    {
      "version": "1.0",
      "type": "plan_rds",
      "data": {
        "id": "plan_123",
        "tenant_id": "tenant_456",
        "plan_name": "Q4 Marketing Campaign",
        "budget": 50000,
        "created_at": "2024-08-12T10:00:00Z"
      },
      "canonical": "{\"budget\":50000,\"created_at\":\"2024-08-12T10:00:00Z\",\"id\":\"plan_123\",\"plan_name\":\"Q4 Marketing Campaign\",\"tenant_id\":\"tenant_456\"}",
      "hash": "a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456",
      "signature": {
        "algorithm": "SHA256-HMAC",
        "signature": "def456789012345678901234567890abcdef123456789012345678901234567890",
        "timestamp": "2024-08-12T10:00:01Z"
      },
      "timestamp": "2024-08-12T10:00:01Z",
      "metadata": {
        "jurisdiction": "US",
        "regulation": "SEC",
        "classification": "internal"
      }
    }
  ]
}